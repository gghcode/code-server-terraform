{
    "variables": {
        "name": "Code Server Prod v{{isotime \"060102-1504\"}}",
        "source_ami": "ami-0a25005e83c56767a",
        "access_key": "{{ env `AWS_ACCESS_KEY_ID` }}",
        "secret_key": "{{ env `AWS_SECRET_ACCESS_KEY` }}",
        "region": "{{ env `AWS_DEFAULT_REGION` }}",
        "ssh_username": "ubuntu"
    },
    "sensitive-variables": [
        "access_key", 
        "secret_key",
        "region",
        "ssh_username"
    ],
    "builders": [{
        "type": "amazon-ebs",
        "access_key": "{{ user `access_key` }}",
        "secret_key":"{{ user `secret_key` }}",
        "ami_name": "{{ user `name` }}",
        "region": "{{ user `region` }}",
        "source_ami": "{{ user `source_ami` }}",
        "instance_type": "t3.micro",
        "communicator": "ssh",
        "ssh_username": "{{ user `ssh_username` }}"
    }],
    "provisioners": [
        {
            "type": "ansible",
            "user": "{{user `ssh_username`}}",
            "playbook_file": "playbook/production.yml"
        }
    ]
}
